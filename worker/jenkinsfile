pieline {
    agent any
    
    tools{
        maven 'maven 3.6.1'
    }
    stages{
        stage('BUILD'){
            when{
                changeset "**/worker/**"
            }
            steps{
                echo 'Compling worker app'
                dir('Worker'){
                    sh 'mvn compile'
                }
            }
    }
    stage("Test"){
        when "**/worker/**"
        steps{
            echo "Running Unit Test on Worker app"
            dir('worker'){
                sh 'mvn clean test'
            }
        }
    }
    stage("package"){
        when{
            branch 'master'
            changeset "**/worker/**"
        }
        steps{
            echo 'Running Unit test on worker app..''
            dir('worker'){
                sh 'mvn package -DskipTests'
                archiveArtifacts artifacts: '**/target/*.jar', fingerprint: true }
                
            }
        }
    }
}
post{
    always{
        echo "Building multibranch pipeline for worker is completed.."
    }
}pieline {
    agent any
    
    tools{
        maven 'maven 3.6.1'
    }
    stages{
        stage('BUILD'){
            steps{
                echo 'Compling worker app'
                dir('Worker'){
                    sh 'mvn complie'
                }
            }
    }
    stage("Test"){
        steps{
            echo "Running Unit Test on Worker app"
        }
    }
}
post{
    always{
        echo "Building multibranch pipeline for worker is completed.."
    }
}
